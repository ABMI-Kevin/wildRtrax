<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Acoustic data pre-processing | Environmental sensor data management and analysis with R</title>
  <meta name="description" content="wildRtrax helps environmental sensor data users with data management and analytics" />
  <meta name="generator" content="bookdown 0.30 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Acoustic data pre-processing | Environmental sensor data management and analysis with R" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://abbiodiversity.github.io/wildRtrax/book/assets/cover.png" />
  <meta property="og:description" content="wildRtrax helps environmental sensor data users with data management and analytics" />
  <meta name="github-repo" content="ABbiodiversity/wildRtrax" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Acoustic data pre-processing | Environmental sensor data management and analysis with R" />
  
  <meta name="twitter:description" content="wildRtrax helps environmental sensor data users with data management and analytics" />
  <meta name="twitter:image" content="https://abbiodiversity.github.io/wildRtrax/book/assets/cover.png" />

<meta name="author" content="Alexander G. MacPhail, Marcus Becker, Elly C. Knight" />


<meta name="date" content="2023-03-21" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="1-introduction.html"/>
<link rel="next" href="3-camera-data-pre-processing.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#who-is-this-book-for"><i class="fa fa-check"></i><b>0.1</b> Who is this book for?</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#how-should-i-read-this-book"><i class="fa fa-check"></i><b>0.2</b> How should I read this book?</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#what-is-wildtrax"><i class="fa fa-check"></i><b>0.3</b> What is <strong>WildTrax</strong>?</a></li>
<li class="chapter" data-level="0.4" data-path="index.html"><a href="index.html#why-did-you-build-wildrtrax"><i class="fa fa-check"></i><b>0.4</b> Why did you build <code>wildRtrax</code>?</a></li>
<li class="chapter" data-level="0.5" data-path="index.html"><a href="index.html#impact-and-intentions"><i class="fa fa-check"></i><b>0.5</b> Impact and intentions</a></li>
<li class="chapter" data-level="0.6" data-path="index.html"><a href="index.html#installing-the-package"><i class="fa fa-check"></i><b>0.6</b> Installing the package</a></li>
<li class="chapter" data-level="0.7" data-path="index.html"><a href="index.html#usage"><i class="fa fa-check"></i><b>0.7</b> Usage</a></li>
<li class="chapter" data-level="0.8" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i><b>0.8</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="1-introduction.html"><a href="1-introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="1-introduction.html"><a href="1-introduction.html#environmental-sensors"><i class="fa fa-check"></i><b>1.1</b> Environmental sensors</a></li>
<li class="chapter" data-level="1.2" data-path="1-introduction.html"><a href="1-introduction.html#open-data"><i class="fa fa-check"></i><b>1.2</b> Open data</a></li>
<li class="chapter" data-level="1.3" data-path="1-introduction.html"><a href="1-introduction.html#biological-metrics"><i class="fa fa-check"></i><b>1.3</b> Biological metrics</a></li>
<li class="chapter" data-level="1.4" data-path="1-introduction.html"><a href="1-introduction.html#standardizing-information-pipelines"><i class="fa fa-check"></i><b>1.4</b> Standardizing information pipelines</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="2-acoustic-data-pre-processing.html"><a href="2-acoustic-data-pre-processing.html"><i class="fa fa-check"></i><b>2</b> Acoustic data pre-processing</a><ul>
<li class="chapter" data-level="2.1" data-path="2-acoustic-data-pre-processing.html"><a href="2-acoustic-data-pre-processing.html#acoustic-data-management-basics"><i class="fa fa-check"></i><b>2.1</b> Acoustic data management basics</a><ul>
<li class="chapter" data-level="2.1.1" data-path="2-acoustic-data-pre-processing.html"><a href="2-acoustic-data-pre-processing.html#acoustic-metadata"><i class="fa fa-check"></i><b>2.1.1</b> Acoustic metadata</a></li>
<li class="chapter" data-level="2.1.2" data-path="2-acoustic-data-pre-processing.html"><a href="2-acoustic-data-pre-processing.html#acoustic-file-types"><i class="fa fa-check"></i><b>2.1.2</b> Acoustic file types</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="2-acoustic-data-pre-processing.html"><a href="2-acoustic-data-pre-processing.html#manipulating-recordings"><i class="fa fa-check"></i><b>2.2</b> Manipulating recordings</a><ul>
<li class="chapter" data-level="2.2.1" data-path="2-acoustic-data-pre-processing.html"><a href="2-acoustic-data-pre-processing.html#reading-files"><i class="fa fa-check"></i><b>2.2.1</b> Reading files</a></li>
<li class="chapter" data-level="2.2.2" data-path="2-acoustic-data-pre-processing.html"><a href="2-acoustic-data-pre-processing.html#segmenting-audio-files"><i class="fa fa-check"></i><b>2.2.2</b> Segmenting audio files</a></li>
<li class="chapter" data-level="2.2.3" data-path="2-acoustic-data-pre-processing.html"><a href="2-acoustic-data-pre-processing.html#filtering-audio-files"><i class="fa fa-check"></i><b>2.2.3</b> Filtering audio files</a></li>
<li class="chapter" data-level="2.2.4" data-path="2-acoustic-data-pre-processing.html"><a href="2-acoustic-data-pre-processing.html#geographic-filtering"><i class="fa fa-check"></i><b>2.2.4</b> Geographic filtering</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="2-acoustic-data-pre-processing.html"><a href="2-acoustic-data-pre-processing.html#other-convenience-functions-distance-between-locations"><i class="fa fa-check"></i><b>2.3</b> Other convenience functions: distance between locations</a><ul>
<li class="chapter" data-level="2.3.1" data-path="2-acoustic-data-pre-processing.html"><a href="2-acoustic-data-pre-processing.html#error-handling-and-file-standardization"><i class="fa fa-check"></i><b>2.3.1</b> Error handling and file standardization</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="2-acoustic-data-pre-processing.html"><a href="2-acoustic-data-pre-processing.html#using-acoustic-indices-and-ldfcs"><i class="fa fa-check"></i><b>2.4</b> Using acoustic indices and LDFCs</a><ul>
<li class="chapter" data-level="2.4.1" data-path="2-acoustic-data-pre-processing.html"><a href="2-acoustic-data-pre-processing.html#abiotic-geophonic-and-anthropophonic-signal-detection"><i class="fa fa-check"></i><b>2.4.1</b> Abiotic, geophonic and anthropophonic signal detection</a></li>
<li class="chapter" data-level="2.4.2" data-path="2-acoustic-data-pre-processing.html"><a href="2-acoustic-data-pre-processing.html#biophonic-signal-detection"><i class="fa fa-check"></i><b>2.4.2</b> Biophonic signal detection</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="2-acoustic-data-pre-processing.html"><a href="2-acoustic-data-pre-processing.html#linking-acoustic-data-to-wildtrax"><i class="fa fa-check"></i><b>2.5</b> Linking acoustic data to WildTrax</a><ul>
<li class="chapter" data-level="2.5.1" data-path="2-acoustic-data-pre-processing.html"><a href="2-acoustic-data-pre-processing.html#collecting-files-for-upload-to-wildtrax"><i class="fa fa-check"></i><b>2.5.1</b> Collecting files for upload to WildTrax</a></li>
<li class="chapter" data-level="2.5.2" data-path="2-acoustic-data-pre-processing.html"><a href="2-acoustic-data-pre-processing.html#recognizer-results-transforming-hits-to-tags"><i class="fa fa-check"></i><b>2.5.2</b> Recognizer results: transforming hits to tags</a></li>
<li class="chapter" data-level="2.5.3" data-path="2-acoustic-data-pre-processing.html"><a href="2-acoustic-data-pre-processing.html#making-tasks"><i class="fa fa-check"></i><b>2.5.3</b> Making tasks</a></li>
<li class="chapter" data-level="2.5.4" data-path="2-acoustic-data-pre-processing.html"><a href="2-acoustic-data-pre-processing.html#avoiding-conflict-errors"><i class="fa fa-check"></i><b>2.5.4</b> Avoiding conflict errors</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-camera-data-pre-processing.html"><a href="3-camera-data-pre-processing.html"><i class="fa fa-check"></i><b>3</b> Camera data pre-processing</a></li>
<li class="chapter" data-level="4" data-path="4-acoustic-data-analysis.html"><a href="4-acoustic-data-analysis.html"><i class="fa fa-check"></i><b>4</b> Acoustic data analysis</a><ul>
<li class="chapter" data-level="4.1" data-path="4-acoustic-data-analysis.html"><a href="4-acoustic-data-analysis.html#authorizing-and-downloading-data-from-wildtrax"><i class="fa fa-check"></i><b>4.1</b> Authorizing and downloading data from WildTrax</a></li>
<li class="chapter" data-level="4.2" data-path="4-acoustic-data-analysis.html"><a href="4-acoustic-data-analysis.html#wrangling-data-for-analysis"><i class="fa fa-check"></i><b>4.2</b> Wrangling data for analysis</a><ul>
<li class="chapter" data-level="4.2.1" data-path="4-acoustic-data-analysis.html"><a href="4-acoustic-data-analysis.html#species-identification-and-observer-error"><i class="fa fa-check"></i><b>4.2.1</b> Species identification and observer error</a></li>
<li class="chapter" data-level="4.2.2" data-path="4-acoustic-data-analysis.html"><a href="4-acoustic-data-analysis.html#false-negative-rates-and-birdnet"><i class="fa fa-check"></i><b>4.2.2</b> False negative rates and BirdNET</a></li>
<li class="chapter" data-level="4.2.3" data-path="4-acoustic-data-analysis.html"><a href="4-acoustic-data-analysis.html#abundance-estimation"><i class="fa fa-check"></i><b>4.2.3</b> Abundance estimation</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="4-acoustic-data-analysis.html"><a href="4-acoustic-data-analysis.html#basic-analysis"><i class="fa fa-check"></i><b>4.3</b> Basic analysis</a><ul>
<li class="chapter" data-level="4.3.1" data-path="4-acoustic-data-analysis.html"><a href="4-acoustic-data-analysis.html#species-presence"><i class="fa fa-check"></i><b>4.3.1</b> Species presence</a></li>
<li class="chapter" data-level="4.3.2" data-path="4-acoustic-data-analysis.html"><a href="4-acoustic-data-analysis.html#species-accumulation-and-rarefaction"><i class="fa fa-check"></i><b>4.3.2</b> Species accumulation and rarefaction</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="4-acoustic-data-analysis.html"><a href="4-acoustic-data-analysis.html#advanced-analysis"><i class="fa fa-check"></i><b>4.4</b> Advanced analysis</a><ul>
<li class="chapter" data-level="4.4.1" data-path="4-acoustic-data-analysis.html"><a href="4-acoustic-data-analysis.html#occupancy-modelling"><i class="fa fa-check"></i><b>4.4.1</b> Occupancy modelling</a></li>
<li class="chapter" data-level="4.4.2" data-path="4-acoustic-data-analysis.html"><a href="4-acoustic-data-analysis.html#constructing-a-classifier"><i class="fa fa-check"></i><b>4.4.2</b> Constructing a classifier</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="5-camera-data-analysis.html"><a href="5-camera-data-analysis.html"><i class="fa fa-check"></i><b>5</b> Camera data analysis</a></li>
<li class="chapter" data-level="6" data-path="6-conclusions.html"><a href="6-conclusions.html"><i class="fa fa-check"></i><b>6</b> Conclusions</a></li>
<li class="divider"></li>
<li><a href="https://github.com/abbiodiversity/wildRtrax/book" target="blank">
Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Environmental sensor data management and analysis with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="acoustic-data-pre-processing" class="section level1 hasAnchor">
<h1><span class="header-section-number">Chapter 2</span> Acoustic data pre-processing<a href="2-acoustic-data-pre-processing.html#acoustic-data-pre-processing" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="acoustic-data-management-basics" class="section level2 hasAnchor">
<h2><span class="header-section-number">2.1</span> Acoustic data management basics<a href="2-acoustic-data-pre-processing.html#acoustic-data-management-basics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The first step after an ARU is retrieved from the field is to promptly download and secure the data to create a redundant backup. Having redundant backups not only protects against data loss but also ensures business continuity and minimizes downtime in the event of a system failure or natural disaster. Furthermore, in case there is an issue with the SD card copy during the quality control process, having a redundant backup ensures that a copy of the data can be restored.</p>
<p><img src="assets/sds.png" /></p>
<div id="acoustic-metadata" class="section level3 hasAnchor">
<h3><span class="header-section-number">2.1.1</span> Acoustic metadata<a href="2-acoustic-data-pre-processing.html#acoustic-metadata" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In <code>wildRtrax</code> and WildTrax, there are a few essential components and standards that are required in order for the data to be utilized within this context:</p>
<ul>
<li><a href=""><strong>Location</strong></a>: The physical, geographic place at which environmental sensors were deployed and/or biological data was collected on the landscape. This is how you would associate spatial coordinates to the raw audio data.</li>
<li><strong>Date and time</strong>: The temporal component of the audio recording - when the recording took place. Many time formats are possible but the recommended standard is <code>YYYYMMDD</code></li>
<li><strong>Sample rate</strong>: The frequency at which audio waveforms are captured during analog-to-digital conversion in the environment. Digital audio uses pulse-code modulation and digital signals for sound reproduction, allowing signals to be stored, retrieved and transmitted without any loss of quality. Sampling rates of 44.1 kHz, 48 kHz, or 96 kHz are commonly used for capturing audio within the 20–20,000 Hz range. Higher sampling rates (&gt;96 kHz) are employed to capture ultrasonic species as needed.</li>
</ul>
<p><img src="assets/task.png" /></p>
<p>A <strong>recording</strong> is the raw media or audio file. The following data types are supported within <code>wildRtrax</code> package. They are implicitly related to how each model and type of ARU records data. See <a href="https://www.wildlifeacoustics.com/">Wildlife Acoustics</a>, <a href="https://www.frontierlabs.com.au/bar-lt">Frontier Labs</a> and <a href="https://www.openacousticdevices.info/audiomoth">Open Acoustic Devices</a> for examples to learn more.</p>
<center>
<p><jargon>ABMI-1025-SW</jargon></p>
<p>ABMI-1025-SW_20220406_074500.{<em>wav,wac,flac,mp3</em>}</p>
<p>ABMI-1025-SW_<em>0+1</em>_20220406_074500</p>
</center>
<p>Some additional file name recommendations include:</p>
<ul>
<li>Omitting leading zeros for numeric delimited content, e.g. use <code>OG-1-3-5</code> instead of <code>OG-01-003-05</code>, unless they serve a identification purpose, e.g. <code>3-0-A12</code> where <code>-0-</code> indicates the an absence of a treatment</li>
<li>Metadata are also supported for .dump, .txt, .csv, .fls, and .SM4S files</li>
<li>Delimiters such as “-”, “_”, “@” are supported</li>
<li>Location name strings that appear numeric (35001) should be treated with caution when importing via csv</li>
<li>Spaces and slashes “/” “” in location names are not supported “_000” suffixes from Wildlife Acoustics Kaleidoscope output (wac -&gt; wav conversion) are supported</li>
</ul>
<p>Audio files need to contain both spatial and temporal information which is the minimum required in order to upload media to WildTrax, e.g. <code>ABMI-538-SW_20220506_050000</code>, where <code>ABMI-538-SW</code> is the location and <code>20220506_050000</code> is the timestamp. Both these pieces of information can tell you when and where the recording took place.</p>
</div>
<div id="acoustic-file-types" class="section level3 hasAnchor">
<h3><span class="header-section-number">2.1.2</span> Acoustic file types<a href="2-acoustic-data-pre-processing.html#acoustic-file-types" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><strong>wac</strong> are proprietary, lossless compressed file formats developed by Wildlife Acoustics</li>
<li><strong>wav</strong> is the standard, ubiquitous uncompressed audio file format</li>
<li><strong>mp3</strong> a lossy compressed audio file format; works by reducing the accuracy of certain sound components, and eliminating others</li>
<li><strong>flac</strong> is a lossless compressed audio file format</li>
</ul>
<div class="didyouknow">
<div class="left">
<p><em>Did you know?</em><br>
When data are uploaded to WildTrax, the audio is converted and stored as flac.</p>
</div>
</div>
</div>
</div>
<div id="manipulating-recordings" class="section level2 hasAnchor">
<h2><span class="header-section-number">2.2</span> Manipulating recordings<a href="2-acoustic-data-pre-processing.html#manipulating-recordings" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Monitoring programs often generate an enormous amount of audio data that exceeds human capacity to listen to. To overcome this challenge, we can select specific audio files for upload to WildTrax and processing using predetermined criteria. This approach not only prioritizes important data but also helps minimize data storage costs while maximizing processing power for calculating relevant biological metrics.</p>
<div class="dangerbox">
<div class="left">
<p><em>Keep in mind</em><br>
If you’re not an R user you can stop here and upload all of your recordings directly an organization on WildTrax. WildTrax however does not contain all the necessary data quality control measures to uptake data that are included in <code>wildRtrax</code>.</p>
<ul>
<li>Go to the organization on WildTrax</li>
<li>Go to Manage &gt; Upload Recordings to Organization</li>
<li>Follow the steps in WildTrax to finalize data upload</li>
</ul>
</div>
</div>
<div id="reading-files" class="section level3 hasAnchor">
<h3><span class="header-section-number">2.2.1</span> Reading files<a href="2-acoustic-data-pre-processing.html#reading-files" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The first step in data pre-processing is to determine what files exist. <code>wt_audio_scanner</code> is the function that provides the basis for the rest of the data pre-processing steps. The function recursively scans directories of audio data and returns standard metadata such as the file path, file name, file size, date, time, location name, that will later be used in WildTrax.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="2-acoustic-data-pre-processing.html#cb3-1"></a>files &lt;-<span class="st"> </span><span class="kw">wt_audio_scanner</span>(<span class="dt">path =</span> <span class="st">&quot;../ABMI/ARU/ABMI-EH/2022/V1/228/228-NE&quot;</span>, <span class="dt">file_type =</span> <span class="st">&quot;wav&quot;</span>, <span class="dt">extra_cols =</span> F)</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="2-acoustic-data-pre-processing.html#cb4-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">head</span>(files)</span></code></pre></div>
<pre><code># A tibble: 6 × 11
  file_…¹ size_Mb unsafe file_…² locat…³ recording_date_time file_…⁴ julian  year gps_e…⁵
  &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt;   &lt;dttm&gt;              &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt;  
1 /volum…    3.51 Safe   228-NE… 228-NE  2021-11-21 12:35:49 wav        325  2021 NA     
2 /volum…  106.   Safe   228-NE… 228-NE  2022-03-01 00:00:00 wav         60  2022 NA     
3 /volum…   31.8  Safe   228-NE… 228-NE  2022-03-01 02:00:00 wav         60  2022 NA     
4 /volum…  106.   Safe   228-NE… 228-NE  2022-03-01 08:59:00 wav         60  2022 NA     
5 /volum…   31.8  Safe   228-NE… 228-NE  2022-03-01 10:29:00 wav         60  2022 NA     
6 /volum…   31.8  Safe   228-NE… 228-NE  2022-03-01 12:00:00 wav         60  2022 NA     
# … with 1 more variable: time_index &lt;int&gt;, and abbreviated variable names ¹​file_path,
#   ²​file_name, ³​location, ⁴​file_type, ⁵​gps_enabled</code></pre>
<p>The columns from <code>wt_audio_scanner</code> are generated from the raw media file name in order to associate a file prefix to a location, the time stamp to a date and time, and so on.</p>
<div class="didyouknow">
<div class="left">
<p><em>Did you know?</em><br>
Directories of acoustic data at the ABMI are organized in the following hierarchy.</p>
<ul>
<li><a href="https://www.wildtrax.ca/home/resources/guide/organizations/organization-management.html"><strong>Organization</strong></a>: The institution or organization the data belongs to
Sensor type: ARU</li>
<li><strong>Project</strong>: A <a href="https://www.wildtrax.ca/home/resources/guide/projects/project-management.html">project</a> is a grouping of locations and recordings designed to answer an ecologically relevant question. Such programs at the ABMI include, Ecosystem Health (ABMI-EH), Before-After Dose Response (BADR). with location naming conventions such as ABMI-1025-SW and 2-0-A117, respectively.</li>
<li><strong>Deployment Year</strong>: The year the data was collected. Repeat visits of locations are defined in the year for things like trend data sets.</li>
<li><a href="https://www.wildtrax.ca/home/resources/guide/organizations/visits.html"><strong>Visit</strong></a>: A unique sequential key to define the year and visit the media collection took place, e.g. V1, V2, etc.</li>
<li><strong>Group</strong>: Is the delimited name of a location. It is aggregated in order to represent spatial relationships or clustering within the field project. (e.g. ABMI-1025-SW is the location but ABMI-1025 is the group given it defines a specific clustering of locations for the study design)</li>
<li><a href="https://www.wildtrax.ca/home/resources/guide/organizations/locations.html"><strong>Location</strong></a>: is the joining key to WildTrax and also the base directory to the media</li>
</ul>
</div>
</div>
<p>You can choose <code>extra_cols = T</code> you’ll be supplied with additional columns that can be used to help select recordings, specifically sample rate, length (seconds) and number of channels.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="2-acoustic-data-pre-processing.html#cb6-1"></a>files_extra &lt;-<span class="st"> </span><span class="kw">wt_audio_scanner</span>(<span class="dt">path =</span> ..<span class="op">/</span>ABMI<span class="op">/</span>ARU<span class="op">/</span>ABMI<span class="op">-</span>EH<span class="op">/</span><span class="dv">2022</span><span class="op">/</span>V1<span class="op">/</span><span class="dv">228</span><span class="op">/</span><span class="dv">228</span><span class="op">-</span>NE<span class="st">&quot;, file_type = &quot;</span>wav<span class="st">&quot;, extra_cols = T)</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="2-acoustic-data-pre-processing.html#cb7-1"></a><span class="op">&gt;</span><span class="st"> </span>files_extra</span></code></pre></div>
<pre><code># A tibble: 1,041 × 14
   file_path     size_Mb file_…¹ locat…² recording_date_time file_…³ julian  year gps_e…⁴
   &lt;chr&gt;           &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;dttm&gt;              &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt;  
 1 /volumes/bud…    3.51 228-NE… 228-NE  2021-11-21 12:35:49 wav        325  2021 NA     
 2 /volumes/bud…  106.   228-NE… 228-NE  2022-03-01 00:00:00 wav         60  2022 NA     
 3 /volumes/bud…   31.8  228-NE… 228-NE  2022-03-01 02:00:00 wav         60  2022 NA     
 4 /volumes/bud…  106.   228-NE… 228-NE  2022-03-01 08:59:00 wav         60  2022 NA     
 5 /volumes/bud…   31.8  228-NE… 228-NE  2022-03-01 10:29:00 wav         60  2022 NA     
 6 /volumes/bud…   31.8  228-NE… 228-NE  2022-03-01 12:00:00 wav         60  2022 NA     
 7 /volumes/bud…   31.8  228-NE… 228-NE  2022-03-01 15:00:00 wav         60  2022 NA     
 8 /volumes/bud…   31.8  228-NE… 228-NE  2022-03-01 18:17:00 wav         60  2022 NA     
 9 /volumes/bud…   31.8  228-NE… 228-NE  2022-03-01 20:17:00 wav         60  2022 NA     
10 /volumes/bud…  106.   228-NE… 228-NE  2022-03-02 00:00:00 wav         61  2022 NA     
# … with 1,031 more rows, 5 more variables: time_index &lt;int&gt;, length_seconds &lt;dbl&gt;,
#   sample_rate &lt;dbl&gt;, n_channels &lt;dbl&gt;, unsafe &lt;chr&gt;, and abbreviated variable names
#   ¹​file_name, ²​location, ³​file_type, ⁴​gps_enabled</code></pre>
<div class="dangerbox">
<div class="left">
<p><em>Keep in mind</em><br>
Using the file name and file path from the output of <code>wt_audio_scanner</code> will determine what the location name and time stamp of the recording will be. If you notice that the location name or time stamp is incorrect, you should re-visit the raw audio and determine if it is correct. See the section <a href="2-acoustic-data-pre-processing.html#linking-acoustic-data-to-wildtrax">Linking acoustic data to WildTrax</a> for more information.</p>
</div>
</div>
</div>
<div id="segmenting-audio-files" class="section level3 hasAnchor">
<h3><span class="header-section-number">2.2.2</span> Segmenting audio files<a href="2-acoustic-data-pre-processing.html#segmenting-audio-files" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>It’s possible that recordings are longer than the maximum length WildTrax can currently import (1800 seconds or 320MB). In this case, you can use <code>wt_chop</code> to create intervals of recordings.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="2-acoustic-data-pre-processing.html#cb9-1"></a>files_extra <span class="op">%&gt;%</span></span>
<span id="cb9-2"><a href="2-acoustic-data-pre-processing.html#cb9-2"></a><span class="st">  </span><span class="kw">select</span>(location, recording_date_time, length_seconds) <span class="op">%&gt;%</span></span>
<span id="cb9-3"><a href="2-acoustic-data-pre-processing.html#cb9-3"></a><span class="st">  </span><span class="kw">slice</span>(<span class="dv">2</span>) </span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##   location recording_date_time length_seconds
##   &lt;chr&gt;    &lt;dttm&gt;                       &lt;dbl&gt;
## 1 228-NE   2022-03-01 00:00:00            600</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="2-acoustic-data-pre-processing.html#cb11-1"></a><span class="co"># Select a 10 minute file and chop it into 60 second segments, creating 10 x 60 second files instead of one 10-minute file</span></span>
<span id="cb11-2"><a href="2-acoustic-data-pre-processing.html#cb11-2"></a><span class="kw">wt_chop</span>(<span class="dt">input =</span> fe, <span class="dt">segment_length =</span> <span class="dv">60</span>, <span class="dt">output_folder =</span> <span class="st">&quot;/my/output/folder&quot;</span>)</span></code></pre></div>
<p><code>wt_chop</code> will create <em>modulo recordings</em> as needed; this refers to the remaining portion of the recording that is left over after it has been divided into equal intervals of the chosen duration. For example, if a recording is 120 seconds long and <code>segment_length = 50</code>, the modulo recording would be the final 20 seconds since 50 + 50 + 20 = 120. However, if the chosen interval duration is a factor of the total duration of the recording, there will be no modulo recording. For example, if a 120-second recording is divided into 60-second intervals, there will be no modulo recording since 60 is a factor of 120.</p>
</div>
<div id="filtering-audio-files" class="section level3 hasAnchor">
<h3><span class="header-section-number">2.2.3</span> Filtering audio files<a href="2-acoustic-data-pre-processing.html#filtering-audio-files" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>At this stage, you can use the results from the <code>wt_audio_scanner</code> tibble output in order to select the files you’re interested in. Filtering and selecting files generally aligns with the study design or species you’re interested in capturing. Here’s an example of the ABMI’s Stratified Sampling Design for the Ecosystem Health Monitoring program that’s used to pick recordings across a breadth of dates and times in order to maximize the species inventory collected at a location.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="2-acoustic-data-pre-processing.html#cb12-1"></a><span class="op">&gt;</span><span class="st"> </span>abmi_blocks &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(<span class="kw">data.frame</span>(<span class="dt">julian =</span> <span class="dv">90</span><span class="op">:</span><span class="dv">210</span>) <span class="op">%&gt;%</span></span>
<span id="cb12-2"><a href="2-acoustic-data-pre-processing.html#cb12-2"></a><span class="op">+</span><span class="st">                      </span><span class="kw">crossing</span>(<span class="dt">time_index =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) <span class="op">%&gt;%</span></span>
<span id="cb12-3"><a href="2-acoustic-data-pre-processing.html#cb12-3"></a><span class="op">+</span><span class="st">                      </span><span class="kw">mutate</span>(<span class="dt">blocks =</span> <span class="kw">case_when</span>(julian <span class="op">%in%</span><span class="st"> </span><span class="dv">90</span><span class="op">:</span><span class="dv">139</span> <span class="op">&amp;</span><span class="st"> </span>time_index <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span><span class="st"> </span><span class="dv">9</span>, <span class="co"># Midnights during the spring for owls</span></span>
<span id="cb12-4"><a href="2-acoustic-data-pre-processing.html#cb12-4"></a><span class="op">+</span><span class="st">                                                </span>julian <span class="op">%in%</span><span class="st"> </span><span class="dv">140</span><span class="op">:</span><span class="dv">159</span> <span class="op">&amp;</span><span class="st"> </span>time_index <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span><span class="st"> </span><span class="dv">10</span>, <span class="co"># Midnights for amphibians, nocturnal breeders</span></span>
<span id="cb12-5"><a href="2-acoustic-data-pre-processing.html#cb12-5"></a><span class="op">+</span><span class="st">                                                </span>julian <span class="op">%in%</span><span class="st"> </span><span class="dv">160</span><span class="op">:</span><span class="dv">179</span> <span class="op">&amp;</span><span class="st"> </span>time_index <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span><span class="st"> </span><span class="dv">11</span>, <span class="co"># Midnights for amphibians, nocturnal breeders</span></span>
<span id="cb12-6"><a href="2-acoustic-data-pre-processing.html#cb12-6"></a><span class="op">+</span><span class="st">                                                </span>julian <span class="op">%in%</span><span class="st"> </span><span class="dv">180</span><span class="op">:</span><span class="dv">210</span> <span class="op">&amp;</span><span class="st"> </span>time_index <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span><span class="st"> </span><span class="dv">12</span>, <span class="co"># Midnights for amphibians, nocturnal breeders</span></span>
<span id="cb12-7"><a href="2-acoustic-data-pre-processing.html#cb12-7"></a><span class="op">+</span><span class="st">                                                </span>julian <span class="op">%in%</span><span class="st"> </span><span class="dv">90</span><span class="op">:</span><span class="dv">104</span> <span class="op">&amp;</span><span class="st"> </span>time_index <span class="op">==</span><span class="st"> </span><span class="dv">3</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, <span class="co"># Dawn in winter-spring for residents</span></span>
<span id="cb12-8"><a href="2-acoustic-data-pre-processing.html#cb12-8"></a><span class="op">+</span><span class="st">                                                </span>julian <span class="op">%in%</span><span class="st"> </span><span class="dv">105</span><span class="op">:</span><span class="dv">119</span> <span class="op">&amp;</span><span class="st"> </span>time_index <span class="op">==</span><span class="st"> </span><span class="dv">4</span> <span class="op">~</span><span class="st"> </span><span class="dv">2</span>, <span class="co"># Post-dawn in spring for residents, early arrivers</span></span>
<span id="cb12-9"><a href="2-acoustic-data-pre-processing.html#cb12-9"></a><span class="op">+</span><span class="st">                                                </span>julian <span class="op">%in%</span><span class="st"> </span><span class="dv">120</span><span class="op">:</span><span class="dv">139</span> <span class="op">&amp;</span><span class="st"> </span>time_index <span class="op">==</span><span class="st"> </span><span class="dv">3</span> <span class="op">~</span><span class="st"> </span><span class="dv">3</span>, <span class="co"># Dawn for early arrivers</span></span>
<span id="cb12-10"><a href="2-acoustic-data-pre-processing.html#cb12-10"></a><span class="op">+</span><span class="st">                                                </span>julian <span class="op">%in%</span><span class="st"> </span><span class="dv">140</span><span class="op">:</span><span class="dv">149</span> <span class="op">&amp;</span><span class="st"> </span>time_index <span class="op">==</span><span class="st"> </span><span class="dv">3</span> <span class="op">~</span><span class="st"> </span><span class="dv">4</span>, <span class="co"># Dawn for breeding bird chorus</span></span>
<span id="cb12-11"><a href="2-acoustic-data-pre-processing.html#cb12-11"></a><span class="op">+</span><span class="st">                                                </span>julian <span class="op">%in%</span><span class="st"> </span><span class="dv">150</span><span class="op">:</span><span class="dv">159</span> <span class="op">&amp;</span><span class="st"> </span>time_index <span class="op">==</span><span class="st"> </span><span class="dv">4</span> <span class="op">~</span><span class="st"> </span><span class="dv">5</span>, <span class="co"># Post-dawn breeding season</span></span>
<span id="cb12-12"><a href="2-acoustic-data-pre-processing.html#cb12-12"></a><span class="op">+</span><span class="st">                                                </span>julian <span class="op">%in%</span><span class="st"> </span><span class="dv">160</span><span class="op">:</span><span class="dv">169</span> <span class="op">&amp;</span><span class="st"> </span>time_index <span class="op">==</span><span class="st"> </span><span class="dv">3</span> <span class="op">~</span><span class="st"> </span><span class="dv">6</span>, <span class="co"># Dawn for breeding bird chorus</span></span>
<span id="cb12-13"><a href="2-acoustic-data-pre-processing.html#cb12-13"></a><span class="op">+</span><span class="st">                                                </span>julian <span class="op">%in%</span><span class="st"> </span><span class="dv">170</span><span class="op">:</span><span class="dv">179</span> <span class="op">&amp;</span><span class="st"> </span>time_index <span class="op">==</span><span class="st"> </span><span class="dv">4</span> <span class="op">~</span><span class="st"> </span><span class="dv">7</span>, <span class="co"># Post-dawn breeding season</span></span>
<span id="cb12-14"><a href="2-acoustic-data-pre-processing.html#cb12-14"></a><span class="op">+</span><span class="st">                                                </span>julian <span class="op">%in%</span><span class="st"> </span><span class="dv">180</span><span class="op">:</span><span class="dv">210</span> <span class="op">&amp;</span><span class="st"> </span>time_index <span class="op">==</span><span class="st"> </span><span class="dv">4</span> <span class="op">~</span><span class="st"> </span><span class="dv">8</span>, <span class="co"># Post-dawn late breeding season</span></span>
<span id="cb12-15"><a href="2-acoustic-data-pre-processing.html#cb12-15"></a><span class="op">+</span><span class="st">                                                </span><span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="ot">NA_real_</span>),</span>
<span id="cb12-16"><a href="2-acoustic-data-pre-processing.html#cb12-16"></a><span class="op">+</span><span class="st">                             </span><span class="dt">recs =</span> <span class="kw">case_when</span>(blocks <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">7</span>) <span class="op">~</span><span class="st"> </span><span class="dv">180</span>,</span>
<span id="cb12-17"><a href="2-acoustic-data-pre-processing.html#cb12-17"></a><span class="op">+</span><span class="st">                                              </span><span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="dv">60</span>)))</span>
<span id="cb12-18"><a href="2-acoustic-data-pre-processing.html#cb12-18"></a><span class="op">&gt;</span><span class="st"> </span></span>
<span id="cb12-19"><a href="2-acoustic-data-pre-processing.html#cb12-19"></a><span class="er">&gt;</span><span class="st"> </span><span class="kw">head</span>(abmi_blocks)</span></code></pre></div>
<pre><code># A tibble: 6 × 4
  julian time_index blocks  recs
   &lt;int&gt;      &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt;
1     90          1      9    60
2     90          2     NA    60
3     90          3      1    60
4     90          4     NA    60
5     91          1      9    60
6     91          2     NA    60</code></pre>
<p>Now we can apply these blocks to a set of audio files and filter the desired recordings to the stratified design.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="2-acoustic-data-pre-processing.html#cb14-1"></a><span class="op">&gt;</span><span class="st"> </span>files <span class="op">%&gt;%</span></span>
<span id="cb14-2"><a href="2-acoustic-data-pre-processing.html#cb14-2"></a><span class="op">+</span><span class="st">   </span><span class="kw">inner_join</span>(., abmi_blocks, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;julian&quot;</span> =<span class="st"> &quot;julian&quot;</span>, <span class="st">&quot;time_index&quot;</span> =<span class="st"> &quot;time_index&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb14-3"><a href="2-acoustic-data-pre-processing.html#cb14-3"></a><span class="op">+</span><span class="st">   </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(blocks)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Filter out recordings that don&#39;t fit in a block</span></span>
<span id="cb14-4"><a href="2-acoustic-data-pre-processing.html#cb14-4"></a><span class="op">+</span><span class="st">   </span><span class="kw">group_by</span>(location, blocks) <span class="op">%&gt;%</span></span>
<span id="cb14-5"><a href="2-acoustic-data-pre-processing.html#cb14-5"></a><span class="op">+</span><span class="st">   </span><span class="kw">sample_n</span>(<span class="dv">1</span>, <span class="dt">replace =</span> F) <span class="op">%&gt;%</span></span>
<span id="cb14-6"><a href="2-acoustic-data-pre-processing.html#cb14-6"></a><span class="op">+</span><span class="st">   </span><span class="kw">select</span>(location, recording_date_time)</span></code></pre></div>
<pre><code># A tibble: 12 × 3
# Groups:   location, blocks [12]
   blocks location recording_date_time
    &lt;dbl&gt; &lt;chr&gt;    &lt;dttm&gt;             
 1      1 228-NE   2022-04-05 07:32:00
 2      2 228-NE   2022-04-22 08:21:00
 3      3 228-NE   2022-05-19 05:58:00
 4      4 228-NE   2022-05-28 05:46:00
 5      5 228-NE   2022-06-01 07:12:00
 6      6 228-NE   2022-06-18 05:34:00
 7      7 228-NE   2022-06-24 07:05:00
 8      8 228-NE   2022-06-29 07:08:00
 9      9 228-NE   2022-04-13 00:00:00
10     10 228-NE   2022-05-25 00:00:00
11     11 228-NE   2022-06-27 00:00:00
12     12 228-NE   2022-07-05 00:00:00</code></pre>
<p>The Before-After Dose-Response program is another example of a sampling design. Here, we select four recordings near dawn and one recording at dusk for each location between Julian date 140 and 210, for a total of 15 audio minutes. Again, this approach allows users to maximize species diversity while accounting for processing effort.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="2-acoustic-data-pre-processing.html#cb16-1"></a>b &lt;-<span class="st"> </span><span class="kw">wt_audio_scanner</span>(<span class="dt">path =</span> <span class="st">&quot;../2-0-A25&quot;</span>, <span class="dt">file_type =</span> <span class="st">&quot;wav&quot;</span>, <span class="dt">extra_cols =</span> F)</span>
<span id="cb16-2"><a href="2-acoustic-data-pre-processing.html#cb16-2"></a></span>
<span id="cb16-3"><a href="2-acoustic-data-pre-processing.html#cb16-3"></a><span class="co"># A list of locations donwload from My Organizations &gt; Manage &gt; Download Locations</span></span>
<span id="cb16-4"><a href="2-acoustic-data-pre-processing.html#cb16-4"></a>locs &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;../locations.csv&quot;</span>)</span>
<span id="cb16-5"><a href="2-acoustic-data-pre-processing.html#cb16-5"></a></span>
<span id="cb16-6"><a href="2-acoustic-data-pre-processing.html#cb16-6"></a>bz &lt;-<span class="st"> </span>b <span class="op">%&gt;%</span></span>
<span id="cb16-7"><a href="2-acoustic-data-pre-processing.html#cb16-7"></a><span class="st">  </span><span class="kw">select</span>(file_name<span class="op">:</span>year) <span class="op">%&gt;%</span></span>
<span id="cb16-8"><a href="2-acoustic-data-pre-processing.html#cb16-8"></a><span class="st">  </span><span class="kw">inner_join</span>(., locs, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;location&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb16-9"><a href="2-acoustic-data-pre-processing.html#cb16-9"></a><span class="st">  </span><span class="co"># Ensure time zone is correct</span></span>
<span id="cb16-10"><a href="2-acoustic-data-pre-processing.html#cb16-10"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">recording_date_time =</span> <span class="kw">force_tz</span>(recording_date_time, <span class="st">&quot;US/Mountain&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb16-11"><a href="2-acoustic-data-pre-processing.html#cb16-11"></a><span class="st">  </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span></span>
<span id="cb16-12"><a href="2-acoustic-data-pre-processing.html#cb16-12"></a><span class="st">  </span><span class="co"># Get sun angle, 6 degrees before dawn defines civil twilight period</span></span>
<span id="cb16-13"><a href="2-acoustic-data-pre-processing.html#cb16-13"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">angle =</span> <span class="kw">pull</span>(suncalc<span class="op">::</span><span class="kw">getSunlightPosition</span>(<span class="dt">date =</span> recording_date_time, <span class="dt">lat =</span> latitude, <span class="dt">lon =</span> longitude, <span class="dt">keep =</span> <span class="kw">c</span>(<span class="st">&quot;altitude&quot;</span>))) <span class="op">*</span><span class="st"> </span>(<span class="dv">180</span><span class="op">/</span>pi)) <span class="op">%&gt;%</span></span>
<span id="cb16-14"><a href="2-acoustic-data-pre-processing.html#cb16-14"></a><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></span>
<span id="cb16-15"><a href="2-acoustic-data-pre-processing.html#cb16-15"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">between</span>(angle,<span class="op">-</span><span class="dv">6</span>,<span class="dv">6</span>),</span>
<span id="cb16-16"><a href="2-acoustic-data-pre-processing.html#cb16-16"></a>         <span class="kw">between</span>(julian,<span class="dv">140</span>,<span class="dv">210</span>)) <span class="op">%&gt;%</span></span>
<span id="cb16-17"><a href="2-acoustic-data-pre-processing.html#cb16-17"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">hour =</span> <span class="kw">hour</span>(recording_date_time))</span>
<span id="cb16-18"><a href="2-acoustic-data-pre-processing.html#cb16-18"></a></span>
<span id="cb16-19"><a href="2-acoustic-data-pre-processing.html#cb16-19"></a><span class="co"># Sample one dusk recording</span></span>
<span id="cb16-20"><a href="2-acoustic-data-pre-processing.html#cb16-20"></a>bz1 &lt;-<span class="st"> </span>bz <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb16-21"><a href="2-acoustic-data-pre-processing.html#cb16-21"></a><span class="st">  </span><span class="kw">filter</span>(hour <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">20</span><span class="op">:</span><span class="dv">22</span>)) <span class="op">%&gt;%</span></span>
<span id="cb16-22"><a href="2-acoustic-data-pre-processing.html#cb16-22"></a><span class="st">  </span><span class="kw">sample_n</span>(<span class="dv">1</span>, <span class="dt">replace =</span> F)</span>
<span id="cb16-23"><a href="2-acoustic-data-pre-processing.html#cb16-23"></a><span class="co"># And four dawn recordings</span></span>
<span id="cb16-24"><a href="2-acoustic-data-pre-processing.html#cb16-24"></a>bz2 &lt;-<span class="st"> </span>bz <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb16-25"><a href="2-acoustic-data-pre-processing.html#cb16-25"></a><span class="st">  </span><span class="kw">filter</span>(hour <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">7</span>)) <span class="op">%&gt;%</span></span>
<span id="cb16-26"><a href="2-acoustic-data-pre-processing.html#cb16-26"></a><span class="st">  </span><span class="kw">sample_n</span>(<span class="dv">4</span>, <span class="dt">replace =</span> F)</span>
<span id="cb16-27"><a href="2-acoustic-data-pre-processing.html#cb16-27"></a></span>
<span id="cb16-28"><a href="2-acoustic-data-pre-processing.html#cb16-28"></a><span class="co"># Bind the dawns and dusks together</span></span>
<span id="cb16-29"><a href="2-acoustic-data-pre-processing.html#cb16-29"></a>bzz &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(bz1, bz2)</span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="2-acoustic-data-pre-processing.html#cb17-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">head</span>(bzz)</span></code></pre></div>
<pre><code># A tibble: 5 × 17
  file_name      locat…¹ recording_date_time file_…² julian  year latit…³ longi…⁴ eleva…⁵
  &lt;chr&gt;          &lt;chr&gt;   &lt;dttm&gt;              &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;lgl&gt;  
1 2-0-A25_20210… 2-0-A25 2021-06-26 21:20:00 wav        177  2021    54.9   -112. NA     
2 2-0-A25_20210… 2-0-A25 2021-06-29 05:38:00 wav        180  2021    54.9   -112. NA     
3 2-0-A25_20210… 2-0-A25 2021-06-27 05:37:00 wav        178  2021    54.9   -112. NA     
4 2-0-A25_20210… 2-0-A25 2021-06-26 05:36:00 wav        177  2021    54.9   -112. NA     
5 2-0-A25_20210… 2-0-A25 2021-06-30 05:39:00 wav        181  2021    54.9   -112. NA     
# … with 8 more variables: bufferRadiusMeters &lt;dbl&gt;, isHidden &lt;chr&gt;,
#   trueCoordinates &lt;lgl&gt;, comments &lt;chr&gt;, internal_wildtrax_id &lt;dbl&gt;,
#   internal_update_ts &lt;dttm&gt;, angle &lt;dbl&gt;, hour &lt;int&gt;, and abbreviated variable names
#   ¹​location, ²​file_type, ³​latitude, ⁴​longitude, ⁵​elevationMeters</code></pre>
</div>
<div id="geographic-filtering" class="section level3 hasAnchor">
<h3><span class="header-section-number">2.2.4</span> Geographic filtering<a href="2-acoustic-data-pre-processing.html#geographic-filtering" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Another example of selecting files may be geographic.</p>
<div class="dangerbox">
<div class="left">
<p><em>Keep in mind</em><br>
That you need to manage spatial coordinates along with your locations in order to use these workflows.</p>
</div>
</div>
<p>Here’s an example with selecting recordings with Bird Conservation Regions.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="2-acoustic-data-pre-processing.html#cb19-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb19-2"><a href="2-acoustic-data-pre-processing.html#cb19-2"></a><span class="kw">library</span>(sf)</span>
<span id="cb19-3"><a href="2-acoustic-data-pre-processing.html#cb19-3"></a></span>
<span id="cb19-4"><a href="2-acoustic-data-pre-processing.html#cb19-4"></a><span class="co"># Clean up the locations</span></span>
<span id="cb19-5"><a href="2-acoustic-data-pre-processing.html#cb19-5"></a>locs_next &lt;-<span class="st"> </span>locs <span class="op">%&gt;%</span></span>
<span id="cb19-6"><a href="2-acoustic-data-pre-processing.html#cb19-6"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">if_all</span>(<span class="kw">c</span>(latitude, longitude), <span class="op">~</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(.))) <span class="op">%&gt;%</span></span>
<span id="cb19-7"><a href="2-acoustic-data-pre-processing.html#cb19-7"></a><span class="st">  </span><span class="kw">select</span>(location, latitude, longitude) <span class="op">%&gt;%</span></span>
<span id="cb19-8"><a href="2-acoustic-data-pre-processing.html#cb19-8"></a><span class="st">  </span><span class="kw">distinct</span>()</span>
<span id="cb19-9"><a href="2-acoustic-data-pre-processing.html#cb19-9"></a></span>
<span id="cb19-10"><a href="2-acoustic-data-pre-processing.html#cb19-10"></a><span class="co"># Create a simple features object. Make it valid and set the CRS.</span></span>
<span id="cb19-11"><a href="2-acoustic-data-pre-processing.html#cb19-11"></a>locsset &lt;-<span class="st"> </span><span class="kw">st_as_sf</span>(locs_next <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(location, latitude, longitude) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">distinct</span>(), <span class="dt">coords =</span> <span class="kw">c</span>(<span class="st">&quot;longitude&quot;</span>,<span class="st">&quot;latitude&quot;</span>))</span>
<span id="cb19-12"><a href="2-acoustic-data-pre-processing.html#cb19-12"></a>locsset &lt;-<span class="st"> </span><span class="kw">st_make_valid</span>(locsset)</span>
<span id="cb19-13"><a href="2-acoustic-data-pre-processing.html#cb19-13"></a></span>
<span id="cb19-14"><a href="2-acoustic-data-pre-processing.html#cb19-14"></a><span class="co"># Set to NAD83</span></span>
<span id="cb19-15"><a href="2-acoustic-data-pre-processing.html#cb19-15"></a>locsset &lt;-<span class="st"> </span><span class="kw">st_set_crs</span>(locsset, <span class="dv">4269</span>)</span>
<span id="cb19-16"><a href="2-acoustic-data-pre-processing.html#cb19-16"></a></span>
<span id="cb19-17"><a href="2-acoustic-data-pre-processing.html#cb19-17"></a><span class="co"># Load a shapefile of Terrestrial BCRs of North America</span></span>
<span id="cb19-18"><a href="2-acoustic-data-pre-processing.html#cb19-18"></a>bcrs &lt;-<span class="st"> </span><span class="kw">read_sf</span>(<span class="st">&quot;../BCR_Terrestrial.shp&quot;</span>)</span>
<span id="cb19-19"><a href="2-acoustic-data-pre-processing.html#cb19-19"></a></span>
<span id="cb19-20"><a href="2-acoustic-data-pre-processing.html#cb19-20"></a><span class="co"># Filter to just Alberta</span></span>
<span id="cb19-21"><a href="2-acoustic-data-pre-processing.html#cb19-21"></a>bcrs &lt;-<span class="st"> </span><span class="kw">st_make_valid</span>(bcrs)</span>
<span id="cb19-22"><a href="2-acoustic-data-pre-processing.html#cb19-22"></a>bcrs &lt;-<span class="st"> </span>bcrs <span class="op">%&gt;%</span></span>
<span id="cb19-23"><a href="2-acoustic-data-pre-processing.html#cb19-23"></a><span class="st">  </span><span class="kw">filter</span>(PROVINCE_S <span class="op">==</span><span class="st"> &quot;ALBERTA&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="2-acoustic-data-pre-processing.html#cb20-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">ggplot</span>(bcrs) <span class="op">+</span></span>
<span id="cb20-2"><a href="2-acoustic-data-pre-processing.html#cb20-2"></a><span class="op">+</span><span class="st">   </span><span class="kw">coord_sf</span>(<span class="dt">crs =</span> <span class="dv">4269</span>) <span class="op">+</span></span>
<span id="cb20-3"><a href="2-acoustic-data-pre-processing.html#cb20-3"></a><span class="op">+</span><span class="st">   </span><span class="kw">geom_sf</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> BCRNAME)) <span class="op">+</span></span>
<span id="cb20-4"><a href="2-acoustic-data-pre-processing.html#cb20-4"></a><span class="op">+</span><span class="st">   </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb20-5"><a href="2-acoustic-data-pre-processing.html#cb20-5"></a><span class="op">+</span><span class="st">   </span><span class="kw">scale_fill_viridis_d</span>()</span></code></pre></div>
<p><img src="Environmental-sensor-data-analysis-with-R_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="2-acoustic-data-pre-processing.html#cb21-1"></a><span class="co"># Intersect the locations with the BCRs</span></span>
<span id="cb21-2"><a href="2-acoustic-data-pre-processing.html#cb21-2"></a>out &lt;-<span class="st"> </span><span class="kw">st_intersection</span>(locsset, bcrs)</span>
<span id="cb21-3"><a href="2-acoustic-data-pre-processing.html#cb21-3"></a></span>
<span id="cb21-4"><a href="2-acoustic-data-pre-processing.html#cb21-4"></a><span class="co"># Join it to the original tibble</span></span>
<span id="cb21-5"><a href="2-acoustic-data-pre-processing.html#cb21-5"></a>locss &lt;-<span class="st"> </span>out <span class="op">%&gt;%</span></span>
<span id="cb21-6"><a href="2-acoustic-data-pre-processing.html#cb21-6"></a><span class="st">  </span><span class="kw">inner_join</span>(., locs, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;location&quot;</span> =<span class="st"> &quot;location&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb21-7"><a href="2-acoustic-data-pre-processing.html#cb21-7"></a><span class="st">  </span><span class="co"># Now sample 10 locations per BCR </span></span>
<span id="cb21-8"><a href="2-acoustic-data-pre-processing.html#cb21-8"></a><span class="st">  </span><span class="kw">group_by</span>(BCRNAME) <span class="op">%&gt;%</span></span>
<span id="cb21-9"><a href="2-acoustic-data-pre-processing.html#cb21-9"></a><span class="st">  </span><span class="kw">sample_n</span>(<span class="dv">10</span>, <span class="dt">replace =</span> F) <span class="op">%&gt;%</span></span>
<span id="cb21-10"><a href="2-acoustic-data-pre-processing.html#cb21-10"></a><span class="st">  </span><span class="kw">select</span>(location, BCRNAME)</span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="2-acoustic-data-pre-processing.html#cb22-1"></a><span class="op">&gt;</span><span class="st"> </span>locss <span class="op">%&gt;%</span></span>
<span id="cb22-2"><a href="2-acoustic-data-pre-processing.html#cb22-2"></a><span class="op">+</span><span class="st">   </span><span class="kw">select</span>(location, BCRNAME) <span class="op">%&gt;%</span></span>
<span id="cb22-3"><a href="2-acoustic-data-pre-processing.html#cb22-3"></a><span class="op">+</span><span class="st">   </span><span class="kw">arrange</span>(location)</span></code></pre></div>
<pre><code>Simple feature collection with 50 features and 2 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: -118.4339 ymin: 49.20788 xmax: -110.1006 ymax: 59.94313
Geodetic CRS:  NAD83
# A tibble: 50 × 3
# Groups:   BCRNAME [5]
   location BCRNAME                                    geometry
   &lt;chr&gt;    &lt;chr&gt;                                   &lt;POINT [°]&gt;
 1 1-SW     TAIGA SHIELD AND HUDSON PLAINS (-110.2824 59.94313)
 2 1034-NE  NORTHERN ROCKIES               (-118.4339 54.11292)
 3 1061-NE  PRAIRIE POTHOLES               (-110.3721 53.32069)
 4 1080-NW  BOREAL TAIGA PLAINS            (-114.5621 53.66429)
 5 1178-NW  BOREAL TAIGA PLAINS             (-114.7144 53.1047)
 6 1183-SE  PRAIRIE POTHOLES                (-113.2496 52.9434)
 7 1228-SW  NORTHERN ROCKIES               (-118.3432 53.04099)
 8 1230-NW  NORTHERN ROCKIES               (-117.8028 52.98812)
 9 1329-SW  PRAIRIE POTHOLES               (-114.1482 52.16412)
10 1401-NE  NORTHERN ROCKIES               (-115.4333 51.72854)
# … with 40 more rows</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="2-acoustic-data-pre-processing.html#cb24-1"></a><span class="kw">ggplot</span>(bcrs) <span class="op">+</span></span>
<span id="cb24-2"><a href="2-acoustic-data-pre-processing.html#cb24-2"></a><span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">crs =</span> <span class="dv">4269</span>) <span class="op">+</span></span>
<span id="cb24-3"><a href="2-acoustic-data-pre-processing.html#cb24-3"></a><span class="st">  </span><span class="kw">geom_sf</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> BCRNAME)) <span class="op">+</span></span>
<span id="cb24-4"><a href="2-acoustic-data-pre-processing.html#cb24-4"></a><span class="st">  </span><span class="kw">geom_sf</span>(locss, <span class="dt">mapping =</span> <span class="kw">aes</span>()) <span class="op">+</span></span>
<span id="cb24-5"><a href="2-acoustic-data-pre-processing.html#cb24-5"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb24-6"><a href="2-acoustic-data-pre-processing.html#cb24-6"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span></span>
<span id="cb24-7"><a href="2-acoustic-data-pre-processing.html#cb24-7"></a><span class="st">  </span><span class="kw">scale_fill_viridis_d</span>()</span></code></pre></div>
<p><img src="Environmental-sensor-data-analysis-with-R_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
<div id="landcover-proportions" class="section level4 hasAnchor">
<h4><span class="header-section-number">2.2.4.1</span> Landcover proportions<a href="2-acoustic-data-pre-processing.html#landcover-proportions" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Ecologists often study the spatial proportions of different landcover types within a given area to understand the distribution and diversity of species, as well as the functioning of ecosystems. Spatial proportions can influence ecosystem processes such as nutrient cycling, water availability, and habitat fragmentation, which can in turn affect biodiversity and ecosystem services. Landcover change, driven by human activities such as land use conversion and climate change, can alter spatial proportions and have significant impacts on ecosystem dynamics and services, highlighting the importance of monitoring and managing landcover patterns.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="2-acoustic-data-pre-processing.html#cb25-1"></a><span class="co"># ABMI 2010 W2W Landcover</span></span>
<span id="cb25-2"><a href="2-acoustic-data-pre-processing.html#cb25-2"></a>LP &lt;-<span class="st"> </span><span class="kw">read_sf</span>(<span class="st">&quot;.../Lancover_Polygons_2010.shp&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb25-3"><a href="2-acoustic-data-pre-processing.html#cb25-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">LC_name =</span> <span class="kw">case_when</span>(LC_class <span class="op">==</span><span class="st"> </span><span class="dv">20</span> <span class="op">~</span><span class="st"> &quot;Water&quot;</span>,</span>
<span id="cb25-4"><a href="2-acoustic-data-pre-processing.html#cb25-4"></a>                             LC_class <span class="op">==</span><span class="st"> </span><span class="dv">31</span> <span class="op">~</span><span class="st"> &quot;Snow/Ice&quot;</span>,</span>
<span id="cb25-5"><a href="2-acoustic-data-pre-processing.html#cb25-5"></a>                             LC_class <span class="op">==</span><span class="st">  </span><span class="dv">32</span> <span class="op">~</span><span class="st"> &quot;Rock/Rubble&quot;</span>,</span>
<span id="cb25-6"><a href="2-acoustic-data-pre-processing.html#cb25-6"></a>                             LC_class <span class="op">==</span><span class="st"> </span><span class="dv">33</span> <span class="op">~</span><span class="st"> &quot;Exposed Land&quot;</span>,</span>
<span id="cb25-7"><a href="2-acoustic-data-pre-processing.html#cb25-7"></a>                             LC_class <span class="op">==</span><span class="st"> </span><span class="dv">34</span> <span class="op">~</span><span class="st"> &quot;Developed&quot;</span>,</span>
<span id="cb25-8"><a href="2-acoustic-data-pre-processing.html#cb25-8"></a>                             LC_class <span class="op">==</span><span class="st"> </span><span class="dv">50</span> <span class="op">~</span><span class="st"> &quot;Shrubland&quot;</span>,</span>
<span id="cb25-9"><a href="2-acoustic-data-pre-processing.html#cb25-9"></a>                             LC_class <span class="op">==</span><span class="st">  </span><span class="dv">110</span> <span class="op">~</span><span class="st"> &quot;Grassland&quot;</span>,</span>
<span id="cb25-10"><a href="2-acoustic-data-pre-processing.html#cb25-10"></a>                             LC_class <span class="op">==</span><span class="st"> </span><span class="dv">120</span> <span class="op">~</span><span class="st"> &quot;Agriculture&quot;</span>,</span>
<span id="cb25-11"><a href="2-acoustic-data-pre-processing.html#cb25-11"></a>                             LC_class <span class="op">==</span><span class="st">  </span><span class="dv">210</span> <span class="op">~</span><span class="st"> &quot;Coniferous Forest&quot;</span>,</span>
<span id="cb25-12"><a href="2-acoustic-data-pre-processing.html#cb25-12"></a>                             LC_class <span class="op">==</span><span class="st">  </span><span class="dv">220</span> <span class="op">~</span><span class="st"> &quot;Broadleaf Forest&quot;</span>,</span>
<span id="cb25-13"><a href="2-acoustic-data-pre-processing.html#cb25-13"></a>                             LC_class <span class="op">==</span><span class="st"> </span><span class="dv">230</span> <span class="op">~</span><span class="st"> &quot;Mixed Forest&quot;</span>))</span>
<span id="cb25-14"><a href="2-acoustic-data-pre-processing.html#cb25-14"></a></span>
<span id="cb25-15"><a href="2-acoustic-data-pre-processing.html#cb25-15"></a>colours &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Water&quot;</span> =<span class="st"> &quot;#00BFFF&quot;</span>, </span>
<span id="cb25-16"><a href="2-acoustic-data-pre-processing.html#cb25-16"></a>             <span class="st">&quot;Snow/Ice&quot;</span> =<span class="st"> &quot;#FFFFFF&quot;</span>, </span>
<span id="cb25-17"><a href="2-acoustic-data-pre-processing.html#cb25-17"></a>             <span class="st">&quot;Rock/Rubble&quot;</span> =<span class="st"> &quot;#D3D3D3&quot;</span>,</span>
<span id="cb25-18"><a href="2-acoustic-data-pre-processing.html#cb25-18"></a>             <span class="st">&quot;Exposed Land&quot;</span> =<span class="st"> &quot;#8B4513&quot;</span>, </span>
<span id="cb25-19"><a href="2-acoustic-data-pre-processing.html#cb25-19"></a>             <span class="st">&quot;Developed&quot;</span> =<span class="st"> &quot;#9400D3&quot;</span>,</span>
<span id="cb25-20"><a href="2-acoustic-data-pre-processing.html#cb25-20"></a>             <span class="st">&quot;Shrubland&quot;</span> =<span class="st"> &quot;#008000&quot;</span>,</span>
<span id="cb25-21"><a href="2-acoustic-data-pre-processing.html#cb25-21"></a>             <span class="st">&quot;Grassland&quot;</span> =<span class="st"> &quot;#ADFF2F&quot;</span>,</span>
<span id="cb25-22"><a href="2-acoustic-data-pre-processing.html#cb25-22"></a>             <span class="st">&quot;Agriculture&quot;</span> =<span class="st"> &quot;#FFFF00&quot;</span>,</span>
<span id="cb25-23"><a href="2-acoustic-data-pre-processing.html#cb25-23"></a>             <span class="st">&quot;Coniferous Forest&quot;</span> =<span class="st"> &quot;#006400&quot;</span>,</span>
<span id="cb25-24"><a href="2-acoustic-data-pre-processing.html#cb25-24"></a>             <span class="st">&quot;Broadleaf Forest&quot;</span> =<span class="st"> &quot;#32CD32&quot;</span>,</span>
<span id="cb25-25"><a href="2-acoustic-data-pre-processing.html#cb25-25"></a>             <span class="st">&quot;Mixed Forest&quot;</span> =<span class="st"> &quot;#808000&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="2-acoustic-data-pre-processing.html#cb26-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="co"># Control locations from the Before-After Dose-Response Landscape Unit #2</span></span>
<span id="cb26-2"><a href="2-acoustic-data-pre-processing.html#cb26-2"></a><span class="er">&gt;</span><span class="st"> </span>badr2 &lt;-<span class="st"> </span>locs <span class="op">%&gt;%</span></span>
<span id="cb26-3"><a href="2-acoustic-data-pre-processing.html#cb26-3"></a><span class="op">+</span><span class="st">   </span><span class="kw">filter</span>(<span class="kw">grepl</span>(<span class="st">&#39;^2-0&#39;</span>,location))</span>
<span id="cb26-4"><a href="2-acoustic-data-pre-processing.html#cb26-4"></a><span class="op">&gt;</span><span class="st"> </span></span>
<span id="cb26-5"><a href="2-acoustic-data-pre-processing.html#cb26-5"></a><span class="er">&gt;</span><span class="st"> </span><span class="co"># Big Grid 9 (Touchwood)</span></span>
<span id="cb26-6"><a href="2-acoustic-data-pre-processing.html#cb26-6"></a><span class="er">&gt;</span><span class="st"> </span>bu_locs &lt;-<span class="st"> </span>bu_locs <span class="op">%&gt;%</span></span>
<span id="cb26-7"><a href="2-acoustic-data-pre-processing.html#cb26-7"></a><span class="op">+</span><span class="st">   </span><span class="kw">filter</span>(<span class="kw">grepl</span>(<span class="st">&#39;^BG-9&#39;</span>, location))</span>
<span id="cb26-8"><a href="2-acoustic-data-pre-processing.html#cb26-8"></a><span class="op">&gt;</span><span class="st"> </span></span>
<span id="cb26-9"><a href="2-acoustic-data-pre-processing.html#cb26-9"></a><span class="er">&gt;</span><span class="st"> </span>bu_badr &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(badr2, bu_locs) <span class="op">%&gt;%</span></span>
<span id="cb26-10"><a href="2-acoustic-data-pre-processing.html#cb26-10"></a><span class="op">+</span><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">Project =</span> <span class="kw">case_when</span>(<span class="kw">grepl</span>(<span class="st">&#39;^BG-&#39;</span>,location) <span class="op">~</span><span class="st"> &quot;Big Grids&quot;</span>,<span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;Before-After Dose Response&quot;</span>))</span>
<span id="cb26-11"><a href="2-acoustic-data-pre-processing.html#cb26-11"></a><span class="op">&gt;</span><span class="st"> </span></span>
<span id="cb26-12"><a href="2-acoustic-data-pre-processing.html#cb26-12"></a><span class="er">&gt;</span><span class="st"> </span>bu_badr_map &lt;-<span class="st"> </span><span class="kw">st_as_sf</span>(bu_badr, <span class="dt">coords =</span> <span class="kw">c</span>(<span class="st">&quot;longitude&quot;</span>,<span class="st">&quot;latitude&quot;</span>)) </span>
<span id="cb26-13"><a href="2-acoustic-data-pre-processing.html#cb26-13"></a><span class="op">&gt;</span><span class="st"> </span>bu_badr_map &lt;-<span class="st"> </span><span class="kw">st_make_valid</span>(bu_badr_map)</span>
<span id="cb26-14"><a href="2-acoustic-data-pre-processing.html#cb26-14"></a><span class="op">&gt;</span><span class="st"> </span>bu_badr_map &lt;-<span class="st"> </span><span class="kw">st_set_crs</span>(bu_badr_map, <span class="dv">4269</span>)</span>
<span id="cb26-15"><a href="2-acoustic-data-pre-processing.html#cb26-15"></a><span class="op">&gt;</span><span class="st"> </span>bu_badr_map &lt;-<span class="st"> </span><span class="kw">st_transform</span>(bu_badr_map, <span class="dv">3400</span>)</span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="2-acoustic-data-pre-processing.html#cb27-1"></a><span class="op">&gt;</span><span class="st"> </span>onebadr &lt;-<span class="st"> </span>bu_badr_map <span class="op">%&gt;%</span></span>
<span id="cb27-2"><a href="2-acoustic-data-pre-processing.html#cb27-2"></a><span class="op">+</span><span class="st">   </span><span class="kw">filter</span>(<span class="kw">grepl</span>(<span class="st">&#39;^BG-9&#39;</span>,location))</span>
<span id="cb27-3"><a href="2-acoustic-data-pre-processing.html#cb27-3"></a><span class="op">&gt;</span><span class="st"> </span></span>
<span id="cb27-4"><a href="2-acoustic-data-pre-processing.html#cb27-4"></a><span class="er">&gt;</span><span class="st"> </span>onebadr_buff &lt;-<span class="st"> </span><span class="kw">st_buffer</span>(onebadr, <span class="dv">150</span>)</span>
<span id="cb27-5"><a href="2-acoustic-data-pre-processing.html#cb27-5"></a><span class="op">&gt;</span><span class="st"> </span>onebadr_buff &lt;-<span class="st"> </span><span class="kw">st_transform</span>(onebadr_buff, <span class="dv">3400</span>)</span>
<span id="cb27-6"><a href="2-acoustic-data-pre-processing.html#cb27-6"></a><span class="op">&gt;</span><span class="st"> </span></span>
<span id="cb27-7"><a href="2-acoustic-data-pre-processing.html#cb27-7"></a><span class="er">&gt;</span><span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb27-8"><a href="2-acoustic-data-pre-processing.html#cb27-8"></a><span class="op">+</span><span class="st">   </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> <span class="kw">st_crop</span>(LPP_c, <span class="dt">xmin =</span> <span class="dv">723300</span>, <span class="dt">xmax =</span> <span class="dv">729250</span>, <span class="dt">ymin =</span> <span class="dv">6076950</span>, <span class="dt">ymax =</span> <span class="dv">6083050</span>), <span class="kw">aes</span>(<span class="dt">fill=</span>LC_name)) <span class="op">+</span></span>
<span id="cb27-9"><a href="2-acoustic-data-pre-processing.html#cb27-9"></a><span class="op">+</span><span class="st">   </span><span class="kw">geom_sf</span>(onebadr_buff, <span class="dt">mapping =</span> <span class="kw">aes</span>(), <span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">colour=</span><span class="st">&quot;white&quot;</span>) <span class="op">+</span></span>
<span id="cb27-10"><a href="2-acoustic-data-pre-processing.html#cb27-10"></a><span class="op">+</span><span class="st">   </span><span class="kw">geom_sf</span>(onebadr, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">colour =</span> Project)) <span class="op">+</span></span>
<span id="cb27-11"><a href="2-acoustic-data-pre-processing.html#cb27-11"></a><span class="op">+</span><span class="st">   </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb27-12"><a href="2-acoustic-data-pre-processing.html#cb27-12"></a><span class="op">+</span><span class="st">   </span><span class="kw">scale_colour_viridis_d</span>() <span class="op">+</span></span>
<span id="cb27-13"><a href="2-acoustic-data-pre-processing.html#cb27-13"></a><span class="op">+</span><span class="st">   </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> colours)</span></code></pre></div>
<p><img src="Environmental-sensor-data-analysis-with-R_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="2-acoustic-data-pre-processing.html#cb28-1"></a><span class="op">&gt;</span><span class="st"> </span>inp &lt;-<span class="st"> </span><span class="kw">st_intersection</span>(LPP_c, onebadr_buff) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb28-2"><a href="2-acoustic-data-pre-processing.html#cb28-2"></a><span class="op">+</span><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">intersect_area =</span> <span class="kw">st_area</span>(.)) <span class="op">%&gt;%</span><span class="st">   </span><span class="co"># create new column with shape area</span></span>
<span id="cb28-3"><a href="2-acoustic-data-pre-processing.html#cb28-3"></a><span class="op">+</span><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">select</span>(location, LC_name, intersect_area) <span class="op">%&gt;%</span><span class="st">   </span><span class="co"># only select columns needed to merge</span></span>
<span id="cb28-4"><a href="2-acoustic-data-pre-processing.html#cb28-4"></a><span class="op">+</span><span class="st">    </span><span class="kw">st_drop_geometry</span>() <span class="op">%&gt;%</span></span>
<span id="cb28-5"><a href="2-acoustic-data-pre-processing.html#cb28-5"></a><span class="op">+</span><span class="st">    </span><span class="kw">group_by</span>(location, LC_name) <span class="op">%&gt;%</span></span>
<span id="cb28-6"><a href="2-acoustic-data-pre-processing.html#cb28-6"></a><span class="op">+</span><span class="st">    </span><span class="kw">summarise</span>(<span class="dt">intersect_area =</span> <span class="kw">sum</span>(intersect_area)) <span class="op">%&gt;%</span></span>
<span id="cb28-7"><a href="2-acoustic-data-pre-processing.html#cb28-7"></a><span class="op">+</span><span class="st">    </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></span>
<span id="cb28-8"><a href="2-acoustic-data-pre-processing.html#cb28-8"></a><span class="op">+</span><span class="st">    </span><span class="kw">pivot_wider</span>(<span class="dt">names_from =</span> LC_name, <span class="dt">values_from =</span> intersect_area) <span class="op">%&gt;%</span></span>
<span id="cb28-9"><a href="2-acoustic-data-pre-processing.html#cb28-9"></a><span class="op">+</span><span class="st">    </span><span class="kw">mutate_all</span>(<span class="op">~</span><span class="kw">replace</span>(., <span class="kw">is.na</span>(.), <span class="dv">0</span>)) <span class="op">%&gt;%</span></span>
<span id="cb28-10"><a href="2-acoustic-data-pre-processing.html#cb28-10"></a><span class="op">+</span><span class="st">    </span><span class="kw">mutate</span>(<span class="kw">across</span>(<span class="op">-</span>location, <span class="op">~</span><span class="kw">as.numeric</span>(.x))) <span class="op">%&gt;%</span></span>
<span id="cb28-11"><a href="2-acoustic-data-pre-processing.html#cb28-11"></a><span class="op">+</span><span class="st">    </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span></span>
<span id="cb28-12"><a href="2-acoustic-data-pre-processing.html#cb28-12"></a><span class="op">+</span><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">total =</span> <span class="kw">sum</span>(<span class="kw">c_across</span>(<span class="op">-</span>location))) <span class="op">%&gt;%</span></span>
<span id="cb28-13"><a href="2-acoustic-data-pre-processing.html#cb28-13"></a><span class="op">+</span><span class="st">    </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></span>
<span id="cb28-14"><a href="2-acoustic-data-pre-processing.html#cb28-14"></a><span class="op">+</span><span class="st">    </span><span class="kw">mutate</span>(<span class="kw">across</span>(<span class="op">-</span><span class="kw">c</span>(location,total), <span class="op">~</span><span class="st"> </span>.x <span class="op">/</span><span class="st"> </span>total)) <span class="op">%&gt;%</span></span>
<span id="cb28-15"><a href="2-acoustic-data-pre-processing.html#cb28-15"></a><span class="op">+</span><span class="st">    </span><span class="kw">select</span>(<span class="op">-</span>total)</span>
<span id="cb28-16"><a href="2-acoustic-data-pre-processing.html#cb28-16"></a><span class="op">&gt;</span><span class="st"> </span></span>
<span id="cb28-17"><a href="2-acoustic-data-pre-processing.html#cb28-17"></a><span class="er">&gt;</span><span class="st"> </span>inp</span></code></pre></div>
<pre><code># A tibble: 101 × 7
   location `Broadleaf Forest` `Coniferous Forest` `Mixed Forest` Develo…¹  Water Shrub…²
   &lt;chr&gt;                 &lt;dbl&gt;               &lt;dbl&gt;          &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
 1 BG-9-1               0.0128              0.525          0.463     0     0            0
 2 BG-9-10              0.681               0              0.319     0     0            0
 3 BG-9-100             0                   0.0172         0         0.965 0.0176       0
 4 BG-9-101             0                   0.584          0         0.416 0            0
 5 BG-9-11              0.540               0.207          0         0     0.253        0
 6 BG-9-12              0                   0              1         0     0            0
 7 BG-9-13              0.553               0              0.0528    0     0.394        0
 8 BG-9-14              0.978               0              0.0216    0     0            0
 9 BG-9-15              0.213               0              0.787     0     0            0
10 BG-9-16              0.475               0              0         0     0.525        0
# … with 91 more rows, and abbreviated variable names ¹​Developed, ²​Shrubland</code></pre>
</div>
</div>
</div>
<div id="other-convenience-functions-distance-between-locations" class="section level2 hasAnchor">
<h2><span class="header-section-number">2.3</span> Other convenience functions: distance between locations<a href="2-acoustic-data-pre-processing.html#other-convenience-functions-distance-between-locations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As ARUs are placed on the landscape by different organizations, or over time with different projects, it is possible that spatial locations may overlap. <code>wt_location_distances</code> takes a list of locations downloaded from WildTrax and calculates the distances between all pairs of points.</p>
<div class="didyouknow">
<div class="left">
<p><em>Did you know?</em><br>
You can go to Manage &gt; Download Locations in either a project or an organization to get a list of locations and their attributes. Remember, you need to be an organization administration to perform this operation since organizations manage locations.
<img src="" /></p>
</div>
</div>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="2-acoustic-data-pre-processing.html#cb30-1"></a><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb30-2"><a href="2-acoustic-data-pre-processing.html#cb30-2"></a><span class="st">  </span><span class="kw">geom_sf</span>(bu_badr_map, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">colour =</span> Project)) <span class="op">+</span></span>
<span id="cb30-3"><a href="2-acoustic-data-pre-processing.html#cb30-3"></a><span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">crs =</span> <span class="dv">4269</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb30-4"><a href="2-acoustic-data-pre-processing.html#cb30-4"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb30-5"><a href="2-acoustic-data-pre-processing.html#cb30-5"></a><span class="st">  </span><span class="kw">scale_colour_viridis_d</span>() <span class="op">+</span></span>
<span id="cb30-6"><a href="2-acoustic-data-pre-processing.html#cb30-6"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> colours) <span class="op">+</span></span>
<span id="cb30-7"><a href="2-acoustic-data-pre-processing.html#cb30-7"></a><span class="st">  </span><span class="kw">guides</span>(<span class="dt">shape =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">alpha =</span> <span class="fl">0.2</span>)))</span></code></pre></div>
<p><img src="Environmental-sensor-data-analysis-with-R_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="2-acoustic-data-pre-processing.html#cb31-1"></a>distances &lt;-<span class="st"> </span><span class="kw">wt_location_distances</span>(<span class="dt">input_from_tibble =</span> bu_badr)</span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="2-acoustic-data-pre-processing.html#cb32-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="co"># Filter points less then 100 meters apart</span></span>
<span id="cb32-2"><a href="2-acoustic-data-pre-processing.html#cb32-2"></a><span class="er">&gt;</span><span class="st"> </span>distances <span class="op">%&gt;%</span></span>
<span id="cb32-3"><a href="2-acoustic-data-pre-processing.html#cb32-3"></a><span class="op">+</span><span class="st">   </span><span class="kw">filter</span>(distance <span class="op">&lt;</span><span class="st"> </span><span class="dv">100</span>) <span class="op">%&gt;%</span></span>
<span id="cb32-4"><a href="2-acoustic-data-pre-processing.html#cb32-4"></a><span class="op">+</span><span class="st">   </span><span class="kw">arrange</span>(distance) <span class="op">%&gt;%</span></span>
<span id="cb32-5"><a href="2-acoustic-data-pre-processing.html#cb32-5"></a><span class="op">+</span><span class="st">   </span><span class="kw">filter</span>(location_from <span class="op">&lt;</span><span class="st"> </span>distance_to)</span></code></pre></div>
<pre><code># A tibble: 13 × 3
   location_from distance_to distance
   &lt;chr&gt;         &lt;chr&gt;          &lt;dbl&gt;
 1 2-0-A86       BG-9-95         2.63
 2 2-0-A50       BG-9-74         5.46
 3 2-0-A12       BG-9-75         8.86
 4 2-0-A90       BG-9-85        16.6 
 5 2-0-A32       BG-9-92        17.8 
 6 2-0-MA48A     2-0-MA48B      22.5 
 7 2-0-A87       BG-9-94        34.2 
 8 2-0-A88       BG-9-93        34.3 
 9 2-0-MA22A     2-0-MA22B      40.6 
10 2-0-A2        BG-9-84        42.8 
11 2-0-MA49A     2-0-MA49B      46.2 
12 2-0-A30       BG-9-83        74.0 
13 2-0-A85       BG-9-97        93.3 </code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="2-acoustic-data-pre-processing.html#cb34-1"></a></span></code></pre></div>
<div id="error-handling-and-file-standardization" class="section level3 hasAnchor">
<h3><span class="header-section-number">2.3.1</span> Error handling and file standardization<a href="2-acoustic-data-pre-processing.html#error-handling-and-file-standardization" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>wt_audio_scanner</code> will continue to support new file formats and file types. Error handling techniques are being put in place to identify and provide clear messages to users to ensure their data is standard to the WildTrax system before upload. <a href="2-acoustic-data-pre-processing.html#acoustic-data-management-basics">File standardization</a> helps ensure consistency and prevent errors when transferring data across different systems and applications. With these measures, wt_audio_scanner can provide a reliable and versatile tool for working with various audio file formats. Development requests can be submitted as issues to the <a href="https://github.com/ABbiodiversity/wildRtrax/issues">GitHub repository</a>.</p>
</div>
</div>
<div id="using-acoustic-indices-and-ldfcs" class="section level2 hasAnchor">
<h2><span class="header-section-number">2.4</span> Using acoustic indices and LDFCs<a href="2-acoustic-data-pre-processing.html#using-acoustic-indices-and-ldfcs" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><img src="assets/305-SE.png" /></p>
<p><em>Acoustic indices</em> and <em>long-duration false-colour (LDFC)</em> spectrograms are two tools used in the analysis of acoustic data developed by the <a href="https://www.qut.edu.au/about/our-people/academic-profiles/m.towsey">Towsey Lab at QUT</a>.</p>
<p>Acoustic indices are numerical measurements that quantify various aspects of sound using different measurements that reflect the soundscpe. They are used to identify and track patterns of vocal activity over time, generate soundscape and monitor ecosystem-level patterns and changes. Some commonly known acoustic indices include the Acoustic Complexity Index (ACI), which measures the diversity of sound frequencies and amplitudes, and the Normalized Differenced Soundscape Index (NDSI), which measures the relative different between anthropophonic and biophonic sounds.</p>
<p>Long-duration false-color spectrograms are visual representations of acoustic data using index values rather than spectral generation in order to provide detailed views of sound patterns over long periods of time. The use of false-colours allows for easier interpretation of the spectrogram, as different colors can be used to represent different types of sounds. These unique spectrograms are particularly useful in studies of animal vocalizations, as they allow researchers to identify specific vocalizations and track patterns of vocal activity over long periods of time, and determine seasonal phenology patterns.</p>
<div class="dangerbox">
<div class="left">
<p><em>Keep in mind</em>
It’s important to familiarize yourself with the <strong>AP</strong> software before continuing. See <a href="https://ap.qut.ecoacoustics.info/">here</a> for full installation and support.</p>
</div>
</div>
<p><code>wildRtrax</code> utilizes the results of the <strong>AnalysisPrograms</strong> software which generates the csv, json and png files associated to the results, and generates tidy versions of the data that can be joined to the media in order to select recordings based on index values and patterns. Let us demonstrate some different examples while introducing the <code>wt_run_ap</code> and <code>wt_glean_ap</code> functions.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="2-acoustic-data-pre-processing.html#cb35-1"></a><span class="kw">wt_run_ap</span>()</span></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="2-acoustic-data-pre-processing.html#cb36-1"></a><span class="kw">wt_glean_ap</span>()</span></code></pre></div>
<div id="abiotic-geophonic-and-anthropophonic-signal-detection" class="section level3 hasAnchor">
<h3><span class="header-section-number">2.4.1</span> Abiotic, geophonic and anthropophonic signal detection<a href="2-acoustic-data-pre-processing.html#abiotic-geophonic-and-anthropophonic-signal-detection" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Recorder failure, damaged microphones, or recorders that are placed in an environment where prevailing winds muffle the sounds the ARU can hear, such as in alpine environments, can limit the audio quality in order to process data in an effective way. ~12% of the acoustic data collected by the ABMI between 2015 - 2019 (~12TB / 100TB) had a relatively high geophonic index or a malfunction or failure. Due to the large volume of data that is handled, it is no longer efficient to do these processes manually and these steps should be automated as much as possible. The goals are to find efficient ways to screen and filter audio data with high geophony or to flag and omit recordings that will not be used for processing.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="2-acoustic-data-pre-processing.html#cb37-1"></a><span class="co"># Output the results</span></span>
<span id="cb37-2"><a href="2-acoustic-data-pre-processing.html#cb37-2"></a>aqd &lt;-<span class="st"> </span><span class="kw">wt_glean_ap</span>(<span class="dt">x =</span> f2, <span class="dt">input_dir =</span> <span class="st">&quot;../data&quot;</span>, <span class="dt">purpose =</span> <span class="st">&quot;abiotic&quot;</span>)</span></code></pre></div>
<p>In contrast, noise pollution is a pervasive problem in modern society, with detrimental effects on human health and well-being, wildlife, and ecosystems. There is growing interest in the use of acoustic indices for noise mapping applications. This approach has several advantages over traditional noise mapping methods.</p>
<p>Using acoustic sensors at 310 spatial locations in 2021 across a gradient of human footprint. We recorded sounds for 4-5 days at each location between May and July calculated a range of acoustic indices. We also collected human observations of noise levels (ranked 0-3) and other noise sources (wind, rain, other noise and audio quality) using a standardized survey. We compared the acoustic indices to the human observations to determine the accuracy of the noise map generated from the indices.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="2-acoustic-data-pre-processing.html#cb38-1"></a>map_badr &lt;-<span class="st"> </span><span class="kw">wt_glean</span>(<span class="dt">x =</span> badr, <span class="dt">input_dir =</span> <span class="st">&quot;../data&quot;</span>, <span class="dt">purpose =</span> <span class="st">&quot;abiotic&quot;</span>)</span>
<span id="cb38-2"><a href="2-acoustic-data-pre-processing.html#cb38-2"></a></span></code></pre></div>
</div>
<div id="biophonic-signal-detection" class="section level3 hasAnchor">
<h3><span class="header-section-number">2.4.2</span> Biophonic signal detection<a href="2-acoustic-data-pre-processing.html#biophonic-signal-detection" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can also look at the entire seasonal phenology of an ABMI Ecosystem Health site</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="2-acoustic-data-pre-processing.html#cb39-1"></a><span class="op">&gt;</span><span class="st"> </span>boreal_example &lt;-<span class="st"> </span><span class="kw">wt_glean_ap</span>(<span class="dt">x =</span> boreal_site, <span class="dt">input_dir =</span> <span class="st">&quot;../data&quot;</span>)</span>
<span id="cb39-2"><a href="2-acoustic-data-pre-processing.html#cb39-2"></a><span class="op">&gt;</span><span class="st"> </span></span>
<span id="cb39-3"><a href="2-acoustic-data-pre-processing.html#cb39-3"></a><span class="er">&gt;</span><span class="st"> </span>boreal_example[[<span class="dv">2</span>]]</span></code></pre></div>
<p><img src="assets/280-NE.png" />
The great part about having a list of the <code>.png</code> files is that you can easily manipulate and generate new LDFCs with other attributes.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="2-acoustic-data-pre-processing.html#cb40-1"></a><span class="op">&gt;</span><span class="st"> </span>boreal_example[[<span class="dv">2</span>]] <span class="op">%&gt;%</span></span>
<span id="cb40-2"><a href="2-acoustic-data-pre-processing.html#cb40-2"></a><span class="op">+</span><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">hour =</span> lubridate<span class="op">::</span><span class="kw">hour</span>(recording_date_time)) <span class="op">%&gt;%</span></span>
<span id="cb40-3"><a href="2-acoustic-data-pre-processing.html#cb40-3"></a><span class="op">+</span><span class="st">   </span><span class="kw">filter</span>(hour <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Look at only midnight LDFCs and acoustic index values</span></span>
<span id="cb40-4"><a href="2-acoustic-data-pre-processing.html#cb40-4"></a><span class="op">+</span><span class="st">   </span><span class="kw">map_dfr</span>(<span class="op">~</span><span class="kw">lapply</span>(.))</span></code></pre></div>
<p>While acoustic indices are good at detecting large scale patterns, it is more difficult to detect rare and elusive signals, especially those that exceed the signal-to-noise threshold to capture the signal. It is important to use this along with spectral validation in WildTrax to determine the source of the environmental noise.</p>
</div>
</div>
<div id="linking-acoustic-data-to-wildtrax" class="section level2 hasAnchor">
<h2><span class="header-section-number">2.5</span> Linking acoustic data to WildTrax<a href="2-acoustic-data-pre-processing.html#linking-acoustic-data-to-wildtrax" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="collecting-files-for-upload-to-wildtrax" class="section level3 hasAnchor">
<h3><span class="header-section-number">2.5.1</span> Collecting files for upload to WildTrax<a href="2-acoustic-data-pre-processing.html#collecting-files-for-upload-to-wildtrax" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To organize the process of uploading files to WildTrax smoother, it’s recommended to collect all recordings into a single folder, regardless of where they are stored. Whether you’ve saved them on a server, hard drive, or local drive, this approach can help streamline the uploading process and save you time.</p>
<p>Depending on the operating system you’re using, there are two common ways to handle your files: linking or copying. Linking involves creating a shortcut to the original file, while copying creates a new, duplicate file. Both options can be beneficial, especially if you have files stored in complex, nested structures.</p>
</div>
<div id="recognizer-results-transforming-hits-to-tags" class="section level3 hasAnchor">
<h3><span class="header-section-number">2.5.2</span> Recognizer results: transforming hits to tags<a href="2-acoustic-data-pre-processing.html#recognizer-results-transforming-hits-to-tags" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Wildlife Acoustics offers advanced tools for analyzing wildlife vocalizations. Two of their most popular programs are Songscope and Kaleidoscope that allows users to visualize and identify animal songs and calls and also create and run automated classifiers. The output files from these programs can be transformed into WildTrax tags to be uploaded for verification purposes. This is also the primary mechanism that ultrasonic data makes its way into the system if it is being analyzed in Kaleidoscope.</p>
<div id="sonscope-results" class="section level4 hasAnchor">
<h4><span class="header-section-number">2.5.2.1</span> Sonscope results<a href="2-acoustic-data-pre-processing.html#sonscope-results" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The function <code>wt_songscope_tags</code> reformats the output obtained from a Wildlife Acoustics Songscope recognizer. This transformation involves converting the recognizer tags into tags that do not have a method type. This makes it possible to upload each hit as a tag in a task.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="2-acoustic-data-pre-processing.html#cb41-1"></a>  </span>
<span id="cb41-2"><a href="2-acoustic-data-pre-processing.html#cb41-2"></a><span class="kw">wt_songscope_tags</span>(<span class="dt">input =</span> <span class="st">&quot;.../ABMI-0585_CONIPeent3.4_20_50_results.txt&quot;</span>,</span>
<span id="cb41-3"><a href="2-acoustic-data-pre-processing.html#cb41-3"></a>                  <span class="dt">output =</span> <span class="st">&quot;env&quot;</span>, <span class="co"># Choosing env will save the output as a environment object called &quot;songscope_tags&quot;</span></span>
<span id="cb41-4"><a href="2-acoustic-data-pre-processing.html#cb41-4"></a>                  <span class="dt">species_code =</span> <span class="st">&quot;CONI&quot;</span>,</span>
<span id="cb41-5"><a href="2-acoustic-data-pre-processing.html#cb41-5"></a>                  <span class="dt">method =</span> <span class="st">&quot;1SPT&quot;</span>,</span>
<span id="cb41-6"><a href="2-acoustic-data-pre-processing.html#cb41-6"></a>                  <span class="dt">score_filter =</span> <span class="dv">60</span>,</span>
<span id="cb41-7"><a href="2-acoustic-data-pre-processing.html#cb41-7"></a>                  <span class="dt">vocalization_type =</span> <span class="st">&quot;Call&quot;</span>,</span>
<span id="cb41-8"><a href="2-acoustic-data-pre-processing.html#cb41-8"></a>                  <span class="dt">task_length =</span> <span class="dv">180</span>)</span></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="2-acoustic-data-pre-processing.html#cb42-1"></a><span class="op">&gt;</span><span class="st"> </span>songscope_tags</span></code></pre></div>
<pre><code># A tibble: 139 × 16
# Groups:   location, recordingDate, taskLength, species [139]
   location    recordingDate       method taskL…¹ trans…² species speci…³ vocal…⁴ abund…⁵
   &lt;chr&gt;       &lt;dttm&gt;              &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;     &lt;int&gt; &lt;chr&gt;     &lt;dbl&gt;
 1 ABMI-0585-… 2016-03-03 12:00:00 1SPT       180 Not As… CONI          1 Call          1
 2 ABMI-0585-… 2016-03-14 15:00:00 1SPT       180 Not As… CONI          1 Call          1
 3 ABMI-0585-… 2016-03-18 08:16:00 1SPT       180 Not As… CONI          1 Call          1
 4 ABMI-0585-… 2016-03-26 07:56:00 1SPT       180 Not As… CONI          1 Call          1
 5 ABMI-0585-… 2016-03-30 12:00:00 1SPT       180 Not As… CONI          1 Call          1
 6 ABMI-0585-… 2016-04-04 07:33:00 1SPT       180 Not As… CONI          1 Call          1
 7 ABMI-0585-… 2016-04-15 07:07:00 1SPT       180 Not As… CONI          1 Call          1
 8 ABMI-0585-… 2016-04-27 06:39:00 1SPT       180 Not As… CONI          1 Call          1
 9 ABMI-0585-… 2016-04-27 12:00:00 1SPT       180 Not As… CONI          1 Call          1
10 ABMI-0585-… 2016-04-28 08:07:00 1SPT       180 Not As… CONI          1 Call          1
# … with 129 more rows, 7 more variables: startTime &lt;dbl&gt;, tagLength &lt;dbl&gt;,
#   minFreq &lt;chr&gt;, maxFreq &lt;chr&gt;, internal_tag_id &lt;chr&gt;, Quality &lt;dbl&gt;, Score &lt;dbl&gt;, and
#   abbreviated variable names ¹​taskLength, ²​transcriber, ³​speciesIndividualNumber,
#   ⁴​vocalization, ⁵​abundance</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="2-acoustic-data-pre-processing.html#cb44-1"></a><span class="op">&gt;</span><span class="st"> </span>songscope_tags <span class="op">%&gt;%</span></span>
<span id="cb44-2"><a href="2-acoustic-data-pre-processing.html#cb44-2"></a><span class="op">+</span><span class="st">   </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> Quality<span class="op">:</span>Score, <span class="dt">names_to =</span> <span class="st">&quot;Recognizer Variable&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb44-3"><a href="2-acoustic-data-pre-processing.html#cb44-3"></a><span class="op">+</span><span class="st">   </span><span class="kw">ggplot</span>(., <span class="kw">aes</span>(<span class="dt">x=</span>recordingDate,<span class="dt">y=</span>value)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb44-4"><a href="2-acoustic-data-pre-processing.html#cb44-4"></a><span class="op">+</span><span class="st">   </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.1</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb44-5"><a href="2-acoustic-data-pre-processing.html#cb44-5"></a><span class="op">+</span><span class="st">   </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;loess&quot;</span>, <span class="kw">aes</span>(<span class="dt">colour=</span><span class="st">`</span><span class="dt">Recognizer Variable</span><span class="st">`</span>)) <span class="op">+</span></span>
<span id="cb44-6"><a href="2-acoustic-data-pre-processing.html#cb44-6"></a><span class="op">+</span><span class="st">   </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st">`</span><span class="dt">Recognizer Variable</span><span class="st">`</span>, <span class="dt">scales=</span><span class="st">&quot;free_y&quot;</span>) <span class="op">+</span></span>
<span id="cb44-7"><a href="2-acoustic-data-pre-processing.html#cb44-7"></a><span class="op">+</span><span class="st">   </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb44-8"><a href="2-acoustic-data-pre-processing.html#cb44-8"></a><span class="op">+</span><span class="st">   </span><span class="kw">scale_colour_viridis_d</span>() <span class="op">+</span></span>
<span id="cb44-9"><a href="2-acoustic-data-pre-processing.html#cb44-9"></a><span class="op">+</span><span class="st">   </span><span class="kw">ggtitle</span>(<span class="st">&quot;Quality and Score Results&quot;</span>)</span></code></pre></div>
<p><img src="Environmental-sensor-data-analysis-with-R_files/figure-html/unnamed-chunk-50-1.png" width="672" /></p>
<div class="dangerbox">
<div class="left">
<p><em>Keep in mind</em><br>
For certain monitoring programs that deliberately deploy ARUs over extended periods to detect specific species, a high true negative rate is crucial to confirm the absence of the species when required. This typically involves recording for more extended periods of more than 30 minutes. In such cases, it is advisable to use the <code>wt_chop</code> function to segment the media, upload the resulting recordings to WildTrax, generate a task list, and combine it with the results of <code>wt_songscope_tags</code> to import all the data into WildTrax.</p>
</div>
</div>
</div>
<div id="kaleidoscope-results" class="section level4 hasAnchor">
<h4><span class="header-section-number">2.5.2.2</span> Kaleidoscope results<a href="2-acoustic-data-pre-processing.html#kaleidoscope-results" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><a href="https://www.wildlifeacoustics.com/products/kaleidoscope-pro">Kaleidoscope Pro</a> is a software package that includes a collection of tools designed specifically for bioacoustics analysis work flows. It can be used to automatically identify bat calls and perform cluster analysis (which involves grouping similar calls together), and it also allows the creation and use of classifiers. Once you have used Kaleidoscope to analyze your audio recordings and identify bat calls, you can use the output from Kaleidoscope and transform them into tags using the <code>wt_kaleidoscope_tags</code> function. These tags can then be imported into WildTrax along with the media.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="2-acoustic-data-pre-processing.html#cb45-1"></a><span class="kw">wt_kaleidoscope_tags</span>()</span></code></pre></div>
<p>It’s also recommended to make a list of unique media associated to the tags so WildTrax can merge the audio and tags together.</p>
<p>Once you have your formatted tags and audio prepared:</p>
<ul>
<li>Go to a project on WildTrax</li>
<li>Click Manage &gt; Upload Recordings to upload the media and generate the tasks</li>
<li>Once the recordings are uploaded, click Manage &gt; Upload Tags using the csv output from the <code>wt_kaleidoscope_tags</code> function.</li>
</ul>
<p>Note that <code>wt_kaleidoscope_tags</code>’s data wrangling is “lazy” in that it will attempt the enclose the majority of the signal detected from Kaleidoscope, and assign vocalization types globally. Users are encourage to use <a href="https://www.wildtrax.ca/home/resources/guide/acoustic-data/species-verification.html">Species Verification</a> later in WildTrax in order to make the subsequent batch edits needed to the tags as needed.</p>
</div>
</div>
<div id="making-tasks" class="section level3 hasAnchor">
<h3><span class="header-section-number">2.5.3</span> Making tasks<a href="2-acoustic-data-pre-processing.html#making-tasks" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="2-acoustic-data-pre-processing.html#cb46-1"></a><span class="kw">wt_make_aru_tasks</span>()</span></code></pre></div>
<p>Tasks don’t always have to be recording or community based. Output from tags from Kaleidoscope or Songscope can also be used to generate tasks.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"></code></pre></div>
<p>Once your task csvs are created. Go to the desired project and begin the process up uploading them.</p>
<div class="dangerbox">
<div class="left">
<p><em>Keep in mind</em><br>
If you haven’t uploaded recordings to WildTrax yet, you may as well just filter a set of desired files and upload them while generating this task, skipping this step.</p>
</div>
</div>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="2-acoustic-data-pre-processing.html#cb48-1"></a></span></code></pre></div>
</div>
<div id="avoiding-conflict-errors" class="section level3 hasAnchor">
<h3><span class="header-section-number">2.5.4</span> Avoiding conflict errors<a href="2-acoustic-data-pre-processing.html#avoiding-conflict-errors" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When you upload a recording to WildTrax, it will be permanently stored in the organization in its native length, regardless of whether you generated a task shorter than the recording duration during the initial upload. If you attempt to upload the same recording again, a conflict will arise. To avoid this, it is necessary to first download the list of recordings from the organization, filter out the recordings you plan to upload, and then create a filtering protocol for the remaining recordings. By following this process, you can ensure that there are no conflicts and that all of your recordings are properly organized and managed within WildTrax.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="1-introduction.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="3-camera-data-pre-processing.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": true,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/abbiodiversity/wildRtrax/book/edit/master/02-Acoustic-data-pre-processing.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/abbiodiversity/wildRtrax/book/blob/master/02-Acoustic-data-pre-processing.Rmd",
"text": null
},
"download": ["Environmental sensor data analysis with R.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
},
"toolbar": {
"position": "static"
}
});
});
</script>

</body>

</html>
